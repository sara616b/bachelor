{% include "cms/Modules/MessagesList.html" %}
<div
    class="relative flex flex-col my-4 list-none bg-white rounded-md shadow-md card"
    style="order:{{section.order}};"
>
    <li
        class="relative flex items-stretch justify-start px-4 py-2 hover:cursor-pointer"
        tabindex="0"
    >

        <details
            class="grid w-full"
        >
            <summary
                {% comment %} class="p-4 bg-indigo-50" {% endcomment %}
                class="flex flex-row justify-between w-full px-2 py-6 hide-marker"
            >
                <div
                    class="flex flex-row gap-2"
                >
                    <div
                        class="inline-block w-6 h-6 border border-gray-500"
                        style="background-color:{{section.values|get_value_by_key:'background_color'}};"
                    ></div>
                    Section {{section.order}} - {{section.name}}
                </div>
                <div
                    class="float-right align-middle"
                >
                    <span class="material-icons hover:opacity-60" title="Edit Section">edit</span>
                </div>
            </summary>
            <form
                class="grid gap-2 p-1 mx-2 mt-2 border"
                hx-put="{% url 'EditSectionView' slug=page.slug section_id=section.id %}"
                hx-target="#main"
                hx-swap="innerhtml"
            >
                {% for value in section.values %}
                    {% if value.key == 'wrap_reverse' %}
                        {% include "cms/Components/Checkbox.html" with name=value.key|add_as_string:section.order label="Wrap Reverse?" value=value.value %}
                    {% elif value.key == 'background_color' %}
                        {% include "cms/Components/ColorInput.html" with name=value.key|add_as_string:section.order label="Background Color" value=value.value %}
                    {% elif value.key == 'background_image' %}
                        {% include "cms/Components/TextInput.html" with name=value.key|add_as_string:section.order label="Background Image" value=value.value not_required=True %}
                    {% endif %}
                {% endfor %}
                
                {% include "cms/Components/Button.html" with text="Save Section" type="submit" %}
            </form>
            {% include "Cms/Modules/ColumnEdit.html" %}
        </details>
    </li>
    <li role="separator" class="bg-gray-200 h-[1px]"></li>
    <div class="flex flex-row flex-wrap items-center justify-end p-2">
        <button
            class="relative inline-flex flex-row items-center justify-center px-4 mx-1 text-sm text-red-700 uppercase bg-transparent border-none rounded-md outline-none cursor-pointer select-none hover:bg-red-50 h-9"
            hx-delete="{% url 'DeleteSectionView' slug=page.slug section_id=section.id %}"
            hx-confirm="Are you sure you wish to delete the page?"
            hx-target="#main"
            hx-swap="innerhtml"
        >
            <span class="tracking-wider">Delete</span>
        </button>
        <button
            class="hover:bg-gray-100 px-2 h-auto rounded-md {% if section.order == 1 %}opacity-30{% endif%}"
            hx-post="{% url 'MoveSectionView' slug=page.slug section_id=section.id direction='up' %}"
            hx-target="#main"
            hx-swap="innerhtml"
            {% if section.order == 1 %}disabled{% endif%}
        >
            <span title="Move up">
                <svg xmlns="http://www.w3.org/2000/svg" height="30" viewBox="0 -960 960 960" width="30"><path d="M450-332h60v-182l74 74 42-42-146-146-146 146 42 42 74-74v182Zm30 252q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-156t86-127Q252-817 325-848.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 82-31.5 155T763-197.5q-54 54.5-127 86T480-80Zm0-60q142 0 241-99.5T820-480q0-142-99-241t-241-99q-141 0-240.5 99T140-480q0 141 99.5 240.5T480-140Zm0-340Z"/></svg>
            </span>
        </button>
        <button
            class="hover:bg-gray-100 px-2 rounded-md h-auto
            {% if section.order == sections|length %}opacity-30{% endif %}"
            hx-post="{% url 'MoveSectionView' slug=page.slug section_id=section.id direction="down" %}"
            hx-target="#main"
            hx-swap="innerhtml"
            {% if section.order == sections|length %}disabled{% endif %}
        >
            <span title="Move Down">
                <svg xmlns="http://www.w3.org/2000/svg" height="30" viewBox="0 -960 960 960" width="30"><path d="m480-332 146-146-42-42-74 74v-182h-60v182l-74-74-42 42 146 146Zm0 252q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-156t86-127Q252-817 325-848.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 82-31.5 155T763-197.5q-54 54.5-127 86T480-80Zm0-60q142 0 241-99.5T820-480q0-142-99-241t-241-99q-141 0-240.5 99T140-480q0 141 99.5 240.5T480-140Zm0-340Z"/></svg>
            </span>
        </button>
    </div>
</div>